@model List<Hirafeyat.Models.Order>

<h2>My Orders</h2>

@foreach (var order in Model)
{
    <div class="card mb-4">
        <div class="card-body">
            <h5>Order #@order.Id</h5>
            <p><strong>Status:</strong> @order.Status</p>
            <p><strong>Date:</strong> @order.OrderDate.ToString("dd MMM yyyy")</p>

            <ul>
                @foreach (var item in order.OrderItems)
                {
                    <li>
                        @item.Product.Title - Quantity: @item.Quantity - Price: @item.Product.Price × @item.Quantity = @(@item.Product.Price * @item.Quantity)
                    </li>
                }
            </ul>

            <p><strong>Total:</strong> @order.OrderItems.Sum(i => i.Product.Price * i.Quantity) EGP</p>

            @if (order.Status != OrderStatus.Shipped && order.Status != OrderStatus.Delivered)
            {
                <form asp-action="CancelOrder" method="post">
                    <input type="hidden" name="id" value="@order.Id" />
                    <button type="submit" class="btn btn-danger">Cancel Order</button>
                </form>
            }
        </div>
    </div>
}
